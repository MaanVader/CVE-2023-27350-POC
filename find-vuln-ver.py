import requests
from bs4 import BeautifulSoup
import re

def vuln_version():
    ip = input("Enter the ip address: ")
    url = "http://"+ip+":9191"+"/app?service=page/SetupCompleted"
    response = requests.get(url)
    soup = BeautifulSoup(response.text, 'html.parser')
    text_div = soup.find('div', class_='text')
    product_span = text_div.find('span', class_='product')

    # Search for the first span element containing a version number
    version_span = None
    for span in text_div.find_all('span'):
        version_match = re.match(r'^\d+\.\d+\.\d+$', span.text.strip())
        if version_match:
            version_span = span
            break

    if version_span is None:
        print('Not found')
    else:
        version_str = version_span.text.strip()
        print('Version:', version_str)
        try:
            version_tuple = tuple(map(int, version_str.split('.')))
            if (8, 0) <= version_tuple <= (22, 0, 4):
                print('Vulnerable to cve-2023-27350')
            else:
                print('Not Vulnerable')
        except ValueError:
            print('Invalid version format')
        ##print(url)


if __name__ =="__main__":
    vuln_version()
